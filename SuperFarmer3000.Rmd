---
title: "SuperFarmer"
author: "[Hanna Kranas](https://github.com/hansiu), [Joanna Zbijewska](https://github.com/joannazbijewska)"
date: "21 paŸdziernika 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r global_options, include=FALSE}
knitr::opts_chunk$set(warning=FALSE,message =FALSE)
```
```{r load_packages, include=FALSE}
library(microbenchmark)
library(ggplot2)
```
#**Definicje niezbêdnych wartoœci**#  
Stada
```{r stada, results="hide", eval=FALSE}
stado_glowne <<- c(60,24,20,12,6,4,2)
stado <<- c(0,0,0,0,0,0,0)
## R,S,P,C,H,L,B
## gdzie R - krolik, S - owca, P - swinia, C - krowa, H - kon, L - maly pies, B - duzy pies
```
Kostki
```{r kostki, results="hide"}
kostka_zielona <- c('R','R','R','R','R','R','S','S','S','P','C','W')
kostka_czerwona <- c('R','R','R','R','R','R','S','S','P','P','H','F')
##gdzie: W - wilk, F - lis; reszta jak wyzej
```
Wektory wymian
```{r wektory_wymian, results="hide"}
##Wektory wymian o takiej samej strukturze jak stado i stado_glowne
kon <- c(72,12,6,2,1,12,2)
krowa <- c(36,6,3,1,0,6,1)
swinia <- c(12,2,1,0,0,2,0)
owca <- c(6,1,0,0,0,1,0)
maly_pies <- c(6,1,0,0,0,1,0)
duzy_pies <- c(36,6,3,1,0,6,1)
##ile innych zwierzat trzeba aby wymienic na dane zwierze

```
#**Funkcje pomocnicze**#  
Funkcja licz¹ca ile otrzymamy ze stada g³ównego, z tego co nam siê nale¿y
```{r licz, result="hide"}
licz_ile_otrzyma <- function(sie_nalezy){
  if (all(sie_nalezy <= stado_glowne)){
    return(sie_nalezy)
  } else {
    sie_nalezy <- ifelse(sie_nalezy <= stado_glowne, sie_nalezy, stado_glowne)
    return(sie_nalezy)
  }
}
```
Funkcja wykonuj¹ca czynnoœæ przekazywania zwierz¹t miêdzy stadem a stadem g³ównym
```{r wykonaj, result="hide"}
wykonaj_czynnosc <- function(co, jak='+'){
  if (jak=='+'){ ## dodajemy do stada
    stado <<- stado + co
    stado_glowne <<- stado_glowne - co
  } else { ## odejmujemy ze stada
    stado <<- stado - co
    stado_glowne <<- stado_glowne + co
  }
  if (!all(stado+stado_glowne==c(60,24,20,12,6,4,2))){
    break ##przerywamy gre - stada sie nie sumuja
  }
}
```
Funkcja sprawdzaj¹ca czy staæ nas na wygran¹ i zakoñczaj¹ca grê
```{r zakoncz, result="hide"}
zakoncz <- function(x=stado){
  if(all(stado >= c(1,1,1,1,1,0,0))){
    return(TRUE) ## jesli mamy wiecej lub rowno zwierzat, to wygralismy
  } else { 
    suma = 0
    for (i in 1:7){
      switch(i,
             "1"={suma <- suma + stado[i]},
             "2"={suma <- suma + 6*stado[i]},
             "3"={suma <- suma + 12*stado[i]},
             "4"={suma <- suma + 36*stado[i]},
             "5"={suma <- suma + 72*stado[i]},
             "6"={suma <- suma + 6*stado[i]},
             "7"={suma <- suma + 36*stado[i]})
    }
    if (suma >= 127){ ##6+12+36+72+1 = 127 krolikow
      stado <<- c(suma-126,1,1,1,1,0,0)
      stado_glowne <<- (c(60,24,20,12,6,4,2) - stado)
      return(TRUE) ## stac nas na wygrana, wiec tez wygralismy
    }
    return(FALSE) ## jeszcze za malo
  }
}

```
#**Funkcje wymiany**#  
Funkcja sprawdzaj¹ca czy jest ju¿ mo¿liwe wziêcie konia i królika
```{r kon_starczanie, results="hide"}
##podobna do zakoncz
wez_konia <- function(){
  suma = 0
  for (i in 1:7){
    switch(i,
           "1"={suma <- suma + stado[i]},
           "2"={suma <- suma + 6*stado[i]},
           "3"={suma <- suma + 12*stado[i]},
           "4"={suma <- suma + 36*stado[i]},
           "6"={suma <- suma + 6*stado[i]},
           "7"={suma <- suma + 36*stado[i]},
           suma <- suma)
  }
  if (suma >= 73){
    wykonaj_czynnosc(c(stado[1:4],0,stado[6:7]),'-')
    ##usuwamy wszystko ze stada, zeby wymienic na konia i krolika
    if ((suma-72)<=60){
      wykonaj_czynnosc(c((suma-72),0,0,0,1,0,0))
      #bierzemy konia, a resztê w krolikach
    } else {
      while((suma-72)>60){
        wykonaj_czynnosc(c(0,1,0,0,0,0,0))
        suma <- suma - 6
        ##jeœli zabraknie królików, to bierzemy jeszcze w owcach
      }
      wykonaj_czynnosc(c((suma-72),0,0,0,1,0,0))
    }
  } 
  ## jesli nie starczy to nie robimy nic
}
```
Sprawdzanie mo¿liwoœci rozdrobnienia owcy na króliki
```{r owce_kroliki, results="hide"}
owce_na_kroliki <- function(z_owiec=FALSE){
  if(z_owiec==TRUE){if(stado[2]>=1 & stado_glowne[1]>=6){
    wymiana <<- c('R')
    za_wymiane <<- c(0,1,0,0,0,0,0)
    return(wymiana)
  }else{
    wymiana <<- c('pusty')
    za_wymiane <<- c(0,0,0,0,0,0,0)
  }}
}
```
Sprawdzanie mo¿liwoœci rozdrobnienia œwini na owce
```{r swinie_owce, results="hide"}
swinie_na_owce <- function(ze_swin=FALSE){
  if(ze_swin==TRUE){if(stado[3]>=1 & stado_glowne[2]>=2){
    wymiana <<- c('SS')
    za_wymiane <<- c(0,0,1,0,0,0,0)
    return(wymiana)
  }else{
    wymiana <<- c('pusty')
    za_wymiane <<- c(0,0,0,0,0,0,0)
  }}
}
```
**Sprawdzanie mo¿liwoœci wymiany zwierz¹t na te o wiêkszej wartoœci: **  
1. Wymiana na owcê
```{r owca, results="hide"}
wymiana_owca <- function(b){
  if (stado_glowne[2]==0){ ##sprawdzenie czy jest zwierzê w stadzie g³ównym
    wymiana <<- c('pusty')
    za_wymiane <<- c(0,0,0,0,0,0,0)
  } else {
    switch(b,
           krolik={if(stado[1]>=owca[1]){ ##chcemy owcê za króliki
             wymiana <<- c('S')
             za_wymiane <<- c(6,0,0,0,0,0,0)
             return(wymiana)
           }else{ ## sprawdzenie czy starczy królików ze stada na wymianê
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           maly_pies={if(stado[6]>=owca[6]){
             wymiana <<- c('S')
             za_wymiane <<- c(0,0,0,0,0,1,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           owca={if(stado[2]>=owca[2]){
             wymiana <<- c('S')
             za_wymiane <<- c(0,1,0,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           {wymiana <<- c('pusty') ## nie istnieje mo¿liwoœæ wymiany za podane zwierzê
           za_wymiane <<- c(0,0,0,0,0,0,0)
           })
  }
}
```
```{r maly_pies, results="hide", echo=FALSE}
wymiana_maly_pies <- function(b){
  if (stado_glowne[6]==0){
    wymiana <<- c('pusty')
    za_wymiane <<- c(0,0,0,0,0,0,0)
  }else {
    switch(b,
           krolik={if(stado[1]>=maly_pies[1]){
             wymiana <<- c('L')
             za_wymiane <<- c(6,0,0,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           maly_pies={if(stado[6]>=maly_pies[6]){
             wymiana <<- c('L')
             za_wymiane <<- c(0,0,0,0,0,1,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           owca={if(stado[2]>=maly_pies[2]){
             wymiana <<- c('L')
             za_wymiane <<- c(0,1,0,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           {wymiana <<- c('pusty')
           za_wymiane <<- c(0,0,0,0,0,0,0)
           })
  }
}
```
2. Wymiana na œwiniê
```{r swinia, results="hide"}
wymiana_swinia <- function(b){
  ##analogiczna do wymiana_owca
  if (stado_glowne[3]==0){
    wymiana <<- c('pusty')
    za_wymiane <<- c(0,0,0,0,0,0,0)
  }else {
    switch(b,
           krolik={if(stado[1]>=swinia[1]){
             wymiana <<- c('P')
             za_wymiane <<- c(12,0,0,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           maly_pies={if(stado[6]>=swinia[6]){
             wymiana <<- c('P')
             za_wymiane <<- c(0,0,0,0,0,2,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           owca={if(stado[2]>=swinia[2]){
             wymiana <<- c('P')
             za_wymiane <<- c(0,2,0,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           swinia={if(stado[3]>=swinia[3]){
             wymiana <<- c('P')
             za_wymiane <<- c(0,0,1,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           {wymiana <<- c('pusty')
           za_wymiane <<- c(0,0,0,0,0,0,0)
           })
  }
}
```
```{r krowa, results="hide", echo=FALSE}
wymiana_krowa <- function(b){
  ##analogiczna do wymiana_owca i wymiana_swinia
  if (stado_glowne[4]==0){
    wymiana <<- c('pusty')
    za_wymiane <<- c(0,0,0,0,0,0,0)
  }else {
    switch(b,
           krolik={if(stado[1]>=krowa[1]){
             wymiana <<- c('C')
             za_wymiane <<- c(36,0,0,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           maly_pies={if(stado[6]>=krowa[6]){
             wymiana <<- c('C')
             za_wymiane <<- c(0,0,0,0,0,6,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           owca={if(stado[2]>=krowa[2]){
             wymiana <<- c('C')
             za_wymiane <<- c(0,6,0,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           swinia={if(stado[3]>=krowa[3]){
             wymiana <<- c('C')
             za_wymiane <<- c(0,0,3,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           krowa={if(stado[4]>=krowa[4]){
             wymiana <<- c('C')
             za_wymiane <<- c(0,0,0,1,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           duzy_pies={if(stado[7]>=krowa[7]){
             wymiana <<- c('C')
             za_wymiane <<- c(0,0,0,0,0,0,1)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           {wymiana <<- c('pusty')
           za_wymiane <<- c(0,0,0,0,0,0,0)
           })
  }
}
```
```{r duzy_pies, results="hide", echo=FALSE}
wymiana_duzy_pies <<- function(b){
  if (stado_glowne[7]==0){
    wymiana <<- c('pusty')
    za_wymiane <<- c(0,0,0,0,0,0,0)
  } else {
    ##funkcja co do zasady taka sama jak wymiana_krowa
    switch(b,
           krolik={if(stado[1]>=duzy_pies[1]){
             wymiana <<- c('B')
             za_wymiane <<- c(36,0,0,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           maly_pies={if(stado[6]>=duzy_pies[6]){
             wymiana <<- c('B')
             za_wymiane <<- c(0,0,0,0,0,6,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           owca={if(stado[2]>=duzy_pies[2]){
             wymiana <<- c('B')
             za_wymiane <<- c(0,6,0,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           swinia={if(stado[3]>=duzy_pies[3]){
             wymiana <<- c('B')
             za_wymiane <<- c(0,0,3,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           krowa={if(stado[4]>=duzy_pies[4]){
             wymiana <<- c('B')
             za_wymiane <<- c(0,0,0,1,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           duzy_pies={if(stado[7]>=duzy_pies[7]){
             wymiana <<- c('B')
             za_wymiane <<- c(0,0,0,0,0,0,1)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           {wymiana <<- c('pusty')
           za_wymiane <<- c(0,0,0,0,0,0,0)
           })
  }
}
```
...  
6. Wymiana na konia
```{r kon, results="hide"}
wymiana_kon <- function(b){
  ##analogiczna do wymiana_owca, wymiana_swinia....
  if (stado_glowne[5]==0){
    wymiana <<- c('pusty')
    za_wymiane <<- c(0,0,0,0,0,0,0)
  }else {
    switch(b,
           krolik={if(stado[1]>=kon[1]){
             wymiana <<- c('H')
             za_wymiane <<- c(72,0,0,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           maly_pies={if(stado[6]>=kon[6]){
             wymiana <<- c('H')
             za_wymiane <<- c(0,0,0,0,0,12,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           owca={if(stado[2]>=kon[2]){
             wymiana <<- c('H')
             za_wymiane <<- c(0,12,0,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           swinia={if(stado[3]>=kon[3]){
             wymiana <<- c('H')
             za_wymiane <<- c(0,0,6,0,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           krowa={if(stado[4]>=kon[4]){
             wymiana <<- c('H')
             za_wymiane <<- c(0,0,0,2,0,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           kon={if(stado[5]>=kon[5]){
             wymiana <<- c('H')
             za_wymiane <<- c(0,0,0,0,1,0,0)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           duzy_pies={if(stado[7]>=kon[7]){
             wymiana <<- c('H')
             za_wymiane <<- c(0,0,0,0,0,0,2)
             return(wymiana)
           }else{
             wymiana <<- c('pusty')
             za_wymiane <<- c(0,0,0,0,0,0,0)
           }},
           {wymiana <<- c('pusty')
           za_wymiane <<- c(0,0,0,0,0,0,0)
           })
  }
}
```
Dokonanie wymiany
```{r wymiana}
##Wyliczanie zwierzat otrzymanych z wymiany
z_wymiany <- function(zamien = FALSE){
  W <- c(0,0,0,0,0,0,0)
  if(zamien == TRUE){switch(wymiana,
                            R={W <- c(6,0,0,0,0,0,0)},
                            S={W <- c(0,1,0,0,0,0,0)},
                            SS={W <- c(0,2,0,0,0,0,0)},
                            P={W <- c(0,0,1,0,0,0,0)},
                            C={W <- c(0,0,0,1,0,0,0)},
                            H={W <- c(0,0,0,0,1,0,0)},
                            L={W <- c(0,0,0,0,0,1,0)},
                            B={W <- c(0,0,0,0,0,0,1)},
                            {W <- c(0,0,0,0,0,0,0)})}
  return(W)
}

##Wykonanie operacji wymiany na stadach
wymien <- function(z,na){
  wykonaj_czynnosc(z_wymiany(TRUE),'+')
  wykonaj_czynnosc(za_wymiane,'-') ## za_wymiane powstaje przy funkcjach wymiana_cos
}
```
#**Funkcje rzutów**#  
Rzut kostkami
```{r losowanie, results="hide"}
##losowanie rzutu
losuj_rzut_kostek <- function(a=kostka_zielona,b=kostka_czerwona){
  wynik <<- c(sample(a, 1), sample(b, 1))
  return(wynik)
}

##zamiana wyniku rzutu na wektor analogiczny do wektorów stad
zmiana_na_wektor <- function(wynik){
  switch(wynik[1], ##Najpierw wynik z pierwszej kosci
         R={c1 <- c(1,0,0,0,0,0,0)},
         S={c1 <- c(0,1,0,0,0,0,0)},
         P={c1 <- c(0,0,1,0,0,0,0)},
         C={c1 <- c(0,0,0,1,0,0,0)},
         {c1 <- c(0,0,0,0,0,0,0)}
  )
  switch(wynik[2], ##Pozniej wynik z drugiej kosci
         R={c2 <- c(1,0,0,0,0,0,0)},
         S={c2 <- c(0,1,0,0,0,0,0)},
         P={c2 <- c(0,0,1,0,0,0,0)},
         H={c2 <- c(0,0,0,0,1,0,0)},
         {c2 <- c(0,0,0,0,0,0,0)}
  )
  z_rzutu <- (c1+c2)
  return(z_rzutu)
}
```
Dokonywanie rzutu i akcji z nim zwi¹zanych
```{r rzucanie, results="hide"}
rzuc <- function(){
  otrzymane<-c(0,0,0,0,0,0,0)
  kostki<-losuj_rzut_kostek()
  ##jeœli stado puste nie trzeba sprawdzaæ drapie¿nikow
  if (all(stado==0)){
    if (kostki[1]==kostki[2]){ ##sprawdzenie czy kostki s¹ sobie równe
      otrzymane <- licz_ile_otrzyma((zmiana_na_wektor(kostki))/2)
    }
    ## jeœli nie s¹ sobie rowne to nic nie dostajemy
  } else {
    if ('W' %in% kostki){
      if ('F' %in% kostki) {
        atak_drapieznika(TRUE,TRUE) ##atak wilka z lisem!
      } else {
        atak_drapieznika(wilk = TRUE) ##atak wilka
        wylosowane <- zmiana_na_wektor(kostki) ## ale moglismy sie obronic i na drugiej kosci cos wylosowac korzystnego
        otrzymane <- ifelse(wylosowane == 0, 0, trunc((stado+wylosowane)/2)) ## przeliczamy kostki wg. zasady n/2
        otrzymane <- licz_ile_otrzyma(otrzymane)
      }
    } else {
      if ('F' %in% kostki) { ## atak lisa
        atak_drapieznika(TRUE)
      }
      wylosowane <- zmiana_na_wektor(kostki)
      otrzymane <- ifelse(wylosowane == 0, 0, trunc((stado+wylosowane)/2)) ## przeliczamy kostki wg. zasady n/2
      otrzymane <- licz_ile_otrzyma(otrzymane)
    } 
  }
  if (!all(otrzymane==0)){
    wykonaj_czynnosc(otrzymane) ##przekazanie wyniku rzutu miedzy stadami
  } else {
  }
}
```
Przeprowadzenie ataków drapie¿ników
```{r drapiezniki, results="hide"}
atak_drapieznika <- function(lis = FALSE, wilk = FALSE){
  if (wilk == TRUE ){ ##wilk!
    if (stado[7]>0){ ## sprawdzenie posiadania du¿ego psa
      wykonaj_czynnosc(c(0,0,0,0,0,0,1),'-') ## to oznacza: jeden duzy pies. odejmij od stada (dodaj do glownego)
    } else {
      wykonaj_czynnosc(c(stado[1:4],0,0,0),'-') ## to oznacza: wszystkie zwierzeta oprocz konia i psow ktore sa w stadzie. odejmij od stada (dodaj do glownego)
    }
  }
  if (lis == TRUE ){ ##lis!
    if (stado[6]>0){ ## sprawdzenie posiadania mia³ego psa
      wykonaj_czynnosc(c(0,0,0,0,0,1,0),'-') ## to oznacza: jeden maly pies. odejmij od stada (dodaj do glownego)
    } else {
      wykonaj_czynnosc(c(stado[1],0,0,0,0,0,0),'-') ## to oznacza: wszystkie kroliki ktore sa w stadzie. odejmij od stada (dodaj do glownego)
    }
  }
}

```
#**Przeprowadzenie ca³ej gry**#  
**i strategia**
```{r}
zagraj <- function(){
  stado_glowne <<- c(60,24,20,12,6,4,2)
  stado <<- c(0,0,0,0,0,0,0)
  repeat{
    if (!all(stado==0)){ ##jesli stado jest niepuste sprawdzamy czy nie op³aca siê czegoœ wymieniæ
      wez_konia() ##najpierw sprawdzamy czy starczy na konia i krolika
      if (stado[1]>6){ ##wiecej niz 6 krolikow
        if ((stado[6]==0) & (stado[1]>=9)){ ##wiecej niz 9 krolikow i brak malego psa, to bierzemy malego psa
          wymiana_maly_pies('krolik')
          wymien('krolik','maly_pies')
        }
        if (stado[2]>0){ #jesli juz mamy owce, to wymieniamy na nie kroliki
          wymiana_owca('krolik')
          wymien('krolik','owca')
        }
      } else {
        if ((stado[2]>3)&(stado[1]==0)&(stado[6]==0)){ ##nie mamy krolikow, ale wiecej niz 3 owce i brak malego psa
          wymiana_maly_pies('owca') ##wymieniamy jedn¹ owcê na ma³ego psa
          wymien('owca','maly_pies')
          owce_na_kroliki(TRUE) ##a drug¹ na króliki
          wymien('owca','krolik')
        }
        if ((stado[3]>0)&(stado[6])){##jeœli mamy œwiniê ale brak ma³ego psa
          swinie_na_owce(TRUE) ## wymieniamy œwiniê na owce
          wymien('swinia','owca')
          wymiana_maly_pies('owca') ##wymieniamy owcê na ma³ego psa
          wymien('owca','maly_pies')
        }
      }
    }
    rzuc()
    if (zakoncz()==TRUE){
      break
    }
  }
}
```
#**Czas gry**#
```{r echo=FALSE}
mierz_czas <- microbenchmark({zagraj()}, times=10000)
boxplot(mierz_czas, xlab="Pojedyncza gra - zagraj()", ylab='Czas pojedynczej gry',main='Czas trwania gry SuperFarmer')
autoplot(mierz_czas, main='Czas trwania gry SuperFarmer')
qplot(y=time,data=mierz_czas,color='red',xlab="zagraj()", ylab="Czas gry",main='Czas trwania gry SuperFarmer') + scale_y_log10()
print(mierz_czas)

```
```{r eval=FALSE, echo=FALSE}
##testy
##################
rzuc()
#cat(stado)
#cat(stado_glowne)
rzuc()
#cat(stado)
#cat(stado_glowne)
rzuc()
#cat(stado)
#cat(stado_glowne)
rzuc()
#cat(stado)
#cat(stado_glowne)
rzuc()
#cat(stado)
#cat(stado_glowne)
rzuc()
#cat(stado)
#cat(stado_glowne)
##################
stado <- c(7,2,0,0,0,0,0)
stado_glowne <- c(53,22,20,12,6,4,2)
wymiana_swinia('owca')
wymien('owca','swinia')
#cat(stado)
#cat(stado_glowne)
wymiana_swinia('owca')
wymien('owca','swinia')
#cat(stado)
#cat(stado_glowne)
stado <- c(36,0,1,0,0,0,0)
stado_glowne <- c(24,24,19,12,6,4,2)
wymiana_krowa('krolik')
wymien('krolik','krowa')
#cat(stado)
#cat(stado_glowne)
wymiana_duzy_pies('swinia')
wymien('swinia','duzy_pies')
#cat(stado)
#cat(stado_glowne)
stado <- c(5,2,3,0,0,0,0)
stado_glowne <- c(55,22,17,12,6,4,2)
owce_na_kroliki(TRUE)
wymien('krolik','owca')
#cat(stado)
#cat(stado_glowne)
swinie_na_owce(TRUE)
wymien('owca','swinia')
#cat(stado)
#cat(stado_glowne)
owce_na_kroliki(TRUE)
wymien('krolik','owca')
#cat(stado)
#cat(stado_glowne)
owce_na_kroliki(TRUE)
wymien('krolik','owca')
#cat(stado)
#cat(stado_glowne)
stado <- c(57,1,0,0,0,0,0)
stado_glowne <- c(3,23,20,12,6,4,2)
owce_na_kroliki(TRUE)
wymien('krolik','owca')
#cat(stado)
#cat(stado_glowne)
swinie_na_owce(TRUE)
wymien('owca','swinia')
#cat(stado)
#cat(stado_glowne)
```
